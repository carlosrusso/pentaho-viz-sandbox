<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="UTF-8">
  <title>Pentaho Visualisation API - Pentaho Platform JavaScript APIs</title>
  <meta name="description" content="The Pentaho Visualisation API provides a unified way to visualize data across the Pentaho suite (Analyzer, PDI, CDF)."/>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/assets/css/style.css?v=2df9c297ce7cade239974bb48878c54f9af483d0">

</head>
<body class="intro-layout">
    <header class="site-header">
    <a class="logo" href="/">
      <img src="/assets/img/logo.svg" alt="Pentaho" onerror="this.src='http://www.pentaho.com/sites/all/themes/pentaho_resp/logo.svg';">
    </a>
    <h1><a href="/">Pentaho Platform JavaScript APIs</a></h1>
  </header>


  <section class="page-header intro-page-header">
    <div class="page-header-wrapper">
        <h1 class="project-name">Pentaho Visualisation API</h1>
        <h2 class="project-tagline">The Pentaho Visualisation API provides a unified way to visualize data across the Pentaho suite (Analyzer, PDI, CDF).</h2>
        
        <a href="http://github.com/nantunes/pentaho-viz-sandbox" class="btn">View on GitHub</a>
        
        
    </div>
  </section>

  <section class="main-content">
    <h1 id="overview">Overview</h1>
<p>The Pentaho Visualisation API provides a unified way to visualize data across the Pentaho suite (Analyzer, PDI, CDF). The stock CCC charts provide a set of ready-to-use chart types, customisable and extendable.</p>

<p>Visualisations are implemented on top of the <a href="another-page">Type API</a>. That ensures out-of-the-box class inheritance capabilities (reducing code duplication), <a href="another-page">change events</a>, <a href="another-page">validation</a>, <a href="another-page">configuration</a> and <a href="another-page">serialization</a>.</p>

<p>The framework includes 14 visualisation Models (chart types) and corresponding Views (chart implementations).</p>

<blockquote>
  <p><strong>List them</strong></p>
</blockquote>

<p>Views can be further customised by <a href="another-page">configuration</a> (through <a href="another-page">CCC extension points</a> in the case of the stock visualizations) to fit the desired look and feel. They are also interactive, exposing <a href="another-page">actions</a> and showing <a href="another-page">tooltips</a>.</p>

<hr />

<h1 id="creating-a-visualisation">Creating a visualisation</h1>
<p>The following steps will walk you through the creating of a simple visualization. The complete code is available at <a href="https://github.com/pentaho/pentaho-engineering-samples">pentaho/pentaho-engineering-samples</a>. You can clone the sample code into a directory of your choosing.</p>

<h2 id="prerequisites">Prerequisites</h2>
<ul>
  <li>An npm registry compatible package manager like <a href="https://yarnpkg.com">yarn</a> or <a href="https://www.npmjs.com">npm</a>.</li>
</ul>

<h2 id="preparing-the-environment">Preparing the environment</h2>
<div class="callout callout-info"><p>You can skip this section if you choose to clone the sample repository.</p>
<p>In that case you just need to install the dependencies by typing <code>yarn install</code> or <code>npm install</code>.</p>
<p>Then continue to <a href="#implementing-a-custom-visualisation">the next section</a>.</p>
</div>

<h3 id="1-setting-up-the-project">1. Setting up the project</h3>
<ul>
  <li>Create a folder and initialize it (with <code class="highlighter-rouge">yarn init</code> or <code class="highlighter-rouge">npm init</code>);</li>
  <li>Add the VizAPI dependency: <code class="highlighter-rouge">yarn add @nantunes/viz-api</code> or <code class="highlighter-rouge">npm install @nantunes/viz-api --save</code></li>
</ul>

<h3 id="2-creating-a-simple-container">2. Creating a simple container</h3>
<ul>
  <li>Create and edit an HTML file (e.g. <code class="highlighter-rouge">index.html</code>) with the following content:
    <div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
  <span class="c">&lt;!-- load requirejs --&gt;</span>
  <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"node_modules/requirejs/require.js"</span><span class="nt">&gt;&lt;/script&gt;</span>

  <span class="c">&lt;!-- load the VizAPI helper --&gt;</span>
  <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"node_modules/@nantunes/viz-api/loader.js"</span><span class="nt">&gt;&lt;/script&gt;</span>

  <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
    <span class="c1">// use the VizAPI helper to apply requirejs dev environment configurations</span>
    <span class="nx">vizApiHelperDevRequireConfig</span><span class="p">(</span><span class="nx">require</span><span class="p">,</span> <span class="s2">"node_modules/@nantunes/viz-api"</span><span class="p">);</span>

    <span class="nx">require</span><span class="p">([</span>
      <span class="s2">"pentaho/type/Context"</span><span class="p">,</span>
      <span class="s2">"pentaho/data/Table"</span><span class="p">,</span>
      <span class="s2">"pentaho/visual/base/view"</span><span class="p">,</span>
      <span class="s2">"pentaho/visual/samples/calc"</span>
    <span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">Context</span><span class="p">,</span> <span class="nx">Table</span><span class="p">,</span> <span class="nx">baseViewFactory</span><span class="p">,</span> <span class="nx">calcFactory</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Setup up a VizAPI context</span>
      <span class="kd">var</span> <span class="nx">context</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Context</span><span class="p">({</span><span class="na">application</span><span class="p">:</span> <span class="s2">"viz-api-sandbox"</span><span class="p">});</span>

      <span class="c1">// Prepare some test data</span>
      <span class="kd">var</span> <span class="nx">dataTable</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Table</span><span class="p">({</span>
        <span class="na">model</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span><span class="na">name</span><span class="p">:</span> <span class="s2">"family"</span><span class="p">,</span> <span class="na">type</span><span class="p">:</span> <span class="s2">"string"</span><span class="p">,</span> <span class="na">label</span><span class="p">:</span> <span class="s2">"Family"</span><span class="p">},</span>
          <span class="p">{</span><span class="na">name</span><span class="p">:</span> <span class="s2">"sales"</span><span class="p">,</span>  <span class="na">type</span><span class="p">:</span> <span class="s2">"number"</span><span class="p">,</span> <span class="na">label</span><span class="p">:</span> <span class="s2">"Sales"</span><span class="p">}</span>
        <span class="p">],</span>
        <span class="na">rows</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span><span class="na">c</span><span class="p">:</span> <span class="p">[{</span><span class="na">v</span><span class="p">:</span> <span class="s2">"plains"</span><span class="p">,</span> <span class="na">f</span><span class="p">:</span> <span class="s2">"Plains"</span><span class="p">},</span> <span class="mi">123</span><span class="p">]},</span>
          <span class="p">{</span><span class="na">c</span><span class="p">:</span> <span class="p">[{</span><span class="na">v</span><span class="p">:</span> <span class="s2">"cars"</span><span class="p">,</span>   <span class="na">f</span><span class="p">:</span> <span class="s2">"Cars"</span>  <span class="p">},</span> <span class="mi">456</span><span class="p">]}</span>
        <span class="p">]</span>
      <span class="p">});</span>

      <span class="c1">// Create the visualization model</span>
      <span class="kd">var</span> <span class="nx">CalcModel</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">calcFactory</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">model</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CalcModel</span><span class="p">({</span>
        <span class="s2">"data"</span><span class="p">:</span> <span class="nx">dataTable</span><span class="p">,</span>
        <span class="s2">"levels"</span><span class="p">:</span> <span class="p">{</span><span class="na">attributes</span><span class="p">:</span> <span class="p">[</span><span class="s2">"family"</span><span class="p">]},</span>
        <span class="s2">"measure"</span><span class="p">:</span> <span class="p">{</span><span class="na">attributes</span><span class="p">:</span> <span class="p">[</span><span class="s2">"sales"</span><span class="p">]},</span>
        <span class="s2">"operation"</span><span class="p">:</span> <span class="s2">"avg"</span>
      <span class="p">});</span>

      <span class="c1">// Create the visualization view</span>
      <span class="kd">var</span> <span class="nx">BaseView</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">baseViewFactory</span><span class="p">);</span>
      <span class="nx">BaseView</span><span class="p">.</span><span class="nx">createAsync</span><span class="p">({</span>
        <span class="na">domContainer</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"viz_div"</span><span class="p">),</span>
        <span class="na">width</span><span class="p">:</span> <span class="mi">400</span><span class="p">,</span>
        <span class="na">height</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
        <span class="na">model</span><span class="p">:</span> <span class="nx">model</span>
      <span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">view</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Render the visualization</span>
        <span class="nx">view</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>
      <span class="p">});</span>
    <span class="p">});</span>
  <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>

<span class="nt">&lt;body&gt;</span>
  <span class="c">&lt;!-- div that will contain the visualization --&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"viz_div"</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre>
    </div>
  </li>
</ul>

<h3 id="3-test-your-code">3. Test your code</h3>
<ul>
  <li>Open the HTML file in a browser.</li>
</ul>
<div class="callout callout-warning"><p>Directly opening the file through the filesystem will not work when using Google Chrome (and Chromium and possibly other browsers).</p>

<p>Security restrictions disallow the loading of local resources using XHR. That is currently required by the VizAPI to load localization bundles and other resources.</p>

<p>To overcome this limitation you can serve the project files with a HTTP server. There are several simple to use solutions:</p>

<b>Node:</b><pre>npm install -g node-static
static -p 8000</pre>

<b>PHP:</b><pre>php -S localhost:8000</pre>

<b>Python 2:</b><pre>python -m SimpleHTTPServer 8000</pre>

<b>Python 3:</b><pre>python -m http.server 8000</pre>

<b>Ruby:</b><pre>ruby -run -e httpd . -p 8080</pre>
</div>

<h2 id="implementing-a-custom-visualisation">Implementing a custom visualisation</h2>

<h3 id="1-choose-your-model">1. Choose your Model</h3>

<h4 id="__-a-create-a-new-model--extend-an-existing-one">__ a) Create a new model / extend an existing one</h4>
<h5 id="__-visual-roles"><em>__</em> Visual Roles</h5>
<h5 id="__-validation"><em>__</em> Validation</h5>

<h4 id="__-b-reuse-an-existing-model">__ b) Reuse an existing model</h4>
<p>(currently this implies changing the defaultView property of the model through configuration)</p>

<h3 id="2-create-your-view">2. Create your View</h3>

<h4 id="__1-render-methods">__1. Render methods</h4>

<h4 id="__2-interactivity">__2. Interactivity</h4>
<h5 id="__-trigger-select-actions"><em>__</em> Trigger Select actions</h5>
<h5 id="__-trigger-execute-actions"><em>__</em> Trigger Execute actions</h5>
<h5 id="__-tooltips-out-of-scope"><em>__</em> <del>Tooltips</del> [out of scope]</h5>
<h5 id="__-printing--exporting-out-of-scope"><em>__</em> <del>Printing / exporting</del> [out of scope]</h5>

<h4 id="__3-color-pallets-out-of-scope">__3. <del>Color pallets</del> [out of scope]</h4>

<h4 id="__4-themes-2nd-pass">__4. <del>Themes</del> [2nd pass]</h4>

<h4 id="__5-localization-2nd-pass">__5. <del>Localization</del> [2nd pass]</h4>

<h2 id="deploying-your-visualisation">Deploying your visualisation</h2>

<h3 id="packaging">Packaging</h3>
<blockquote>
  <p>Explain the Pentaho Web Packaging, the package.json, the pentaho/service config, the bundling…</p>

  <p><strong>How to package dependencies!</strong> Webjars, feature, kar…</p>
</blockquote>

<h3 id="installing">Installing</h3>
<blockquote>
  <p>Copy to the deploy folder… Submit it to the marketplace?</p>
</blockquote>

<hr />

<h1 id="configuring-visualisations">Configuring visualisations</h1>
<blockquote>
  <p>The config file location, its format, adding configuration rules, priorities, etc..</p>
</blockquote>

<h2 id="migrating-analyzers-settings">Migrating Analyzer’s settings</h2>

  </section>

    <footer class="site-footer">
    <div class="footer-wrapper">
      <h2>Learn More:</h2>
      <ul>
        <li><a href="" target="_blank">Reference documentation</a></li>
        <li><a href="" target="_blank">Pentaho Forums</a></li>
      </ul>
    </div>
  </footer>

    <div class="community-footer">
    <div class="helpImproveWrapper">
      <div class="helpImprove">
        <p>Help us improve this website. Send your feedback to <a href="mailto:community@pentaho.com" class="footer-link">community@pentaho.com</a></p>
        <section class="footer-social-wrapper">
          <div class="region region-footer-social">
            <div class="content text-right">
              <a class="footer-social-item youtube" href="https://www.youtube.com/user/pentaho" target="_blank"></a>
              <a class="footer-social-item gplus" href="https://plus.google.com/+Pentahocorporation/posts" target="_blank"></a>
              <a class="footer-social-item twitter" href="http://twitter.com/Pentaho" target="_blank"></a>
              <a class="footer-social-item facebook" href="http://www.facebook.com/pentaho" target="_blank"></a>
              <a class="footer-social-item linkedin" href="http://www.linkedin.com/company/pentaho" target="_blank"></a>
              <a class="footer-social-item rss-feed" href="http://www.pentaho.com/blog"></a>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>

</body>
</html>
